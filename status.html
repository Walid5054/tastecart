<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Status - TasteCart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY"></script>
    <style>
      #map {
        width: 100%;
        height: 300px;
      }
    </style>
  </head>
  <body class="bg-white text-gray-800">
    <div class="max-w-4xl mx-auto p-6">
      <h1 class="text-3xl font-bold text-sky-600 mb-6">Order Status</h1>

      <div id="orderDetails" class="space-y-4"></div>

      <div class="bg-gray-100 p-4 rounded-lg shadow mt-6">
        <h2 class="text-xl font-semibold mb-2">Preparation & Delivery</h2>
        <p id="prepTime" class="text-gray-700">‚è±Ô∏è Preparing your food...</p>
        <p id="deliveryTime" class="text-gray-700">
          üöó Delivery time estimated shortly.
        </p>
      </div>

      <div class="mt-6">
        <h2 class="text-xl font-semibold mb-2">Live Delivery Tracking</h2>
        <div id="map" class="rounded-lg shadow"></div>
      </div>

      <div class="mt-6 text-center">
        <button
          id="modifyOrderBtn"
          class="bg-yellow-400 hover:bg-yellow-500 text-white font-semibold px-6 py-2 rounded transition"
        >
          Add More Items üçü
        </button>
      </div>
    </div>

    <script>
      const orderDetails = document.getElementById("orderDetails");
      const prepTime = document.getElementById("prepTime");
      const deliveryTime = document.getElementById("deliveryTime");
      const modifyOrderBtn = document.getElementById("modifyOrderBtn");

      const cart = JSON.parse(localStorage.getItem("tasteCartOrder")) || [];

      if (!cart.length) {
        orderDetails.innerHTML = `<p class="text-center text-gray-500">No current orders. Please place one from the menu.</p>`;
        modifyOrderBtn.style.display = "none";
      } else {
        let totalPrice = 0;

        cart.forEach((item) => {
          const quantity = item.quantity || 1;
          const subtotal = item.price * quantity;
          totalPrice += subtotal;

          orderDetails.innerHTML += `
            <div class="border p-4 rounded-lg shadow-md">
              <h3 class="text-lg font-bold">${item.name}</h3>
              <p class="text-gray-600">From: ${item.restaurantName}</p>
              <p class="text-gray-700">Quantity: ${quantity}</p>
              <p class="text-red-500">Subtotal: ‡ß≥${subtotal}</p>
            </div>
          `;
        });

        orderDetails.innerHTML += `
          <div class="text-right font-bold text-xl text-green-600">Total: ‡ß≥${totalPrice}</div>
        `;

        prepTime.innerText = `‚è±Ô∏è Estimated preparation time: 20 minutes.`;
        deliveryTime.innerText = `üöó Estimated delivery time: 30 minutes.`;
      }

      modifyOrderBtn.addEventListener("click", () => {
        window.location.href = "menu.html";
      });

      function initMap() {
        const restaurant = { lat: 23.8103, lng: 90.4125 };
        const customer = { lat: 23.7806, lng: 90.407 };

        const map = new google.maps.Map(document.getElementById("map"), {
          center: restaurant,
          zoom: 12,
        });

        const routePath = new google.maps.Polyline({
          path: [restaurant, customer],
          geodesic: true,
          strokeColor: "#3b82f6",
          strokeOpacity: 1.0,
          strokeWeight: 4,
        });

        routePath.setMap(map);

        new google.maps.Marker({
          position: restaurant,
          map,
          title: "Restaurant",
        });

        new google.maps.Marker({
          position: customer,
          map,
          title: "Your Location",
        });
      }

      window.initMap = initMap;
    </script>

    <script
      async
      defer
      src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&callback=initMap"
    ></script>
  </body>
</html>
